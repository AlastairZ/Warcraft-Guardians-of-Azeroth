create_artifact_craftsman_effect = {
	create_random_steward = {
		female = no
		dynasty = none
		random_traits = yes
		historical = yes
		flag = race_delay_flag
	}

	give_artifact_craftsman_stats_effect = yes
}

create_artifact_craftsman_with_random_culture_effect = {
	create_random_steward = {
		female = no
		dynasty = none
		culture = random
		random_traits = yes
		historical = yes
		flag = race_delay_flag
	}

	give_artifact_craftsman_stats_effect = yes
}

give_artifact_craftsman_stats_effect = {
	new_character = {

		#Type
		ROOT = {
			trigger_switch = {
				on_trigger = has_character_flag
				bought_from_blacksmith	= { new_character = { set_character_flag = craftsman_is_blacksmith			}	}
				bought_from_tailor		= { new_character = { set_character_flag = craftsman_is_tailor				}	}
				bought_from_enchanter	= { new_character = { set_character_flag = craftsman_is_enchanter			}	}
				bought_from_alchemist	= { new_character = { set_character_flag = craftsman_is_alchemist			}	}
				bought_from_jeweler		= { new_character = { set_character_flag = craftsman_is_jeweler				}	}
			}
		}

		#Stats
		health = 1

		# Race
		set_prev_gfx_effect = yes
		character_event = { id = WCRAC.10 }

		# Age
		if = {
			limit = {
				immortal = yes
			}

			random_list = {
				5 = { add_age = 40 }
				5 = { add_age = 50 }
				5 = { add_age = 60 }
				5 = { add_age = 70 }
				5 = { add_age = 80 }
				5 = { add_age = 90 }
				5 = { add_age = 100 }
			}
		}
		
		# Will not marry
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = cannot_marry
		add_character_modifier = {
			modifier = will_not_marry
			duration = -1
		}
		add_trait = cannot_marry
		set_character_flag = no_court_invites
	}
}

upgrade_artifact_craftsman_stats_effect = {
	random = { # Stewardship
		chance = 10
		artisan_craftsmen_bloodline_increase_score = yes

		random_list = {
			250 = {  }
			250 = { change_stewardship = 1 }
			100 = { change_stewardship = 3 }
			10 = {
				artisan_craftsmen_bloodline_increase_score = yes

				change_stewardship = 5
			}
			5 = {
				artisan_craftsmen_bloodline_increase_score = yes

				change_stewardship = 8
			}
			1 = {
				artisan_craftsmen_bloodline_increase_score = yes

				change_stewardship = 10
			}
		}
	}

	random = { # Education
		chance = 10
		modifier = {
			factor = 2
			trait = indulgent_wastrel
		}
		artisan_craftsmen_bloodline_increase_score = yes

		upgrade_education_effect = yes
	}

	#Personality
	random = {
		chance = 10
		artisan_craftsmen_bloodline_increase_score = yes

		add_trait = diligent
	}
}

random_spawn_craftsman_candidates_effect = {
	random_list = {
		95 = { # Craftsman
			event_target:target_artifact_craftsman_employer = {
				artifact_craftsman_is_ok_score = yes
			}

			create_artifact_craftsman_with_random_culture_effect = yes
		}
		5 = { # Fraud
			event_target:target_artifact_craftsman_employer = {
				artifact_craftsman_is_fake_score = yes
			}

			create_artifact_craftsman_with_random_culture_effect = yes
			new_character = {
				set_character_flag = craftsman_is_fake
				random = {
					chance = 25

					add_trait = deceitful
				}
				random_list = {
					100 = {  }
					50 = { change_intrigue = 1 }
					250 = { change_intrigue = 3 }
					50 = { change_intrigue = 5 }
					25 = { change_intrigue = 8 }
					5 = { change_intrigue = 10 }
				}
			}
		}
	}
	new_character = {
		export_to_variable = { which = wc_artifact_craftsman_finding_realm_size_to_stats_variable value = wc_artifact_craftsman_finding_realm_size_variable who = event_target:target_artifact_craftsman_employer }
		while = {
			limit = {
				check_variable = {
					which = wc_artifact_craftsman_finding_realm_size_to_stats_variable
					value = 10
				}
			}
			subtract_variable = {
				which = wc_artifact_craftsman_finding_realm_size_to_stats_variable
				value = 10
			}
			upgrade_artifact_craftsman_stats_effect = yes
		}
		set_variable = { which = wc_artifact_craftsman_finding_realm_size_to_stats_variable value = 0 }
	}
}

artifact_random_up_effect = {
	wealth = local_third_party_score
	random_list = {
		80 = { # success
			custom_tooltip = {
				text = artifact_up_success_tooltip
				character_event = { id = WCAE.3 }
			}
			artifact_up_success_score = yes
		}
		10 = { # minor failure
			custom_tooltip = {
				text = artifact_up_failure_minor_tooltip
				character_event = { id = WCAE.4 }
			}
			artifact_up_failure_score = yes
		}
		5 = { # failure
			custom_tooltip = {
				text = artifact_up_failure_tooltip
				character_event = { id = WCAE.5 }
			}
			artifact_up_failure_score = yes
		}
		5 = { # critical failure
			custom_tooltip = {
				text = artifact_up_critical_failure_tooltip
				character_event = { id = WCAE.6 }
			}
			artifact_up_critical_failure_score = yes
		}
	}
}