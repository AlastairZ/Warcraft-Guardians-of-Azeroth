calculate_artifact_crafting_cost_effect = { # LOCAL_BASE_ARTIFACT_COST_VARIABLE, TARGET_REFORGED_ARTIFACT_CRAFTSMAN, TARGET_REFORGED_ARTIFACT_OWNER and TARGET_REFORGED_ARTIFACT_ARMORY must be saved before this effect

	subtract_variable = { which = local_total_artifact_cost_variable which = local_base_artifact_cost_variable } # How much artifact owner will pay - for artifact

	event_target:target_reforged_artifact_craftsman = { # How much artifact craftsman will get for its work
		if = {
			limit = { craftsman_is_obedient_to_artifact_owner_trigger = no } # Don't require anything if obedient

			set_variable = { which = local_artifact_craftsman_cost_variable which = local_base_artifact_cost_variable }
			multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.2 } # At least 20% of base artifact cost otherwise

			if = {
				limit = { is_level_1_craftsman_trigger = yes }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.8 }
			}
			else_if = {
				limit = { is_level_2_craftsman_trigger = yes }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.9 }
			}
			else_if = {
				limit = { is_level_4_craftsman_trigger = yes }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.1 }
			}
			else_if = {
				limit = { is_level_5_craftsman_trigger = yes }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.2 }
			}

			if = {
				limit = { trait = proud }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.2 }
			}
			else_if = {
				limit = { NOT = { trait = humble trait = depressed } }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.1 }
			}
			else_if = {
				limit = { trait = depressed }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.9 }
			}

			if = {
				limit = { trait = greedy }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.5 }
			}
			else_if = {
				limit = { trait = charitable }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.8 }
			}

			if = {
				limit = { trait = slothful }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.1 }
			}
			else_if = {
				limit = { trait = diligent }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.9 }
			}

			if = {
				limit = { trait = envious }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 1.2 }
			}

			if = {
				limit = { trait = content }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.9 }
			}

			event_target:target_reforged_artifact_owner = {
				if = {
					limit = { any_owned_bloodline = { has_bloodline_flag = bloodline_artisan_craftsmen } }
					multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.75 }
				}
			}

			if = {
				limit = { event_target:target_reforged_artifact_armory = { always = yes } }
				multiply_variable = { which = local_artifact_craftsman_cost_variable value = 0.75 }
			}

			subtract_variable = { which = local_total_artifact_cost_variable which = local_artifact_craftsman_cost_variable } # How much artifact owner will pay - for craftsman work (and artifact)

		}
	}

}

upgrade_THIS_artifact_and_save_it_as_event_target_TARGET_NEW_REFORGED_ARTIFACT = { # If anything, NEW_ARTIFACT don't work after TRIGGER_SWITCH, so I put it inside
	trigger_switch = {
		on_trigger = artifact_type

		## Jewelry
		# Amulets
		amulet_1 = {
			trigger_switch = {
				on_trigger = has_artifact_flag

				future_artifact_stat_diplomacy_flag = { artifact_owner = { add_artifact = amulet_2_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_martial_flag = { artifact_owner = { add_artifact = amulet_2_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_stewardship_flag = { artifact_owner = { add_artifact = amulet_2_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_intrigue_flag = { artifact_owner = { add_artifact = amulet_2_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_learning_flag = { artifact_owner = { add_artifact = amulet_2_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
			}
		}

		amulet_2_diplomacy = { artifact_owner = { add_artifact = amulet_3_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_2_martial = { artifact_owner = { add_artifact = amulet_3_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_2_stewardship = { artifact_owner = { add_artifact = amulet_3_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_2_intrigue = { artifact_owner = { add_artifact = amulet_3_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_2_learning = { artifact_owner = { add_artifact = amulet_3_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		amulet_3_diplomacy = { artifact_owner = { add_artifact = amulet_4_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_3_martial = { artifact_owner = { add_artifact = amulet_4_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_3_stewardship = { artifact_owner = { add_artifact = amulet_4_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_3_intrigue = { artifact_owner = { add_artifact = amulet_4_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_3_learning = { artifact_owner = { add_artifact = amulet_4_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		amulet_4_diplomacy = { artifact_owner = { add_artifact = amulet_5_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_4_martial = { artifact_owner = { add_artifact = amulet_5_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_4_stewardship = { artifact_owner = { add_artifact = amulet_5_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_4_intrigue = { artifact_owner = { add_artifact = amulet_5_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		amulet_4_learning = { artifact_owner = { add_artifact = amulet_5_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		# Rings
		ring_1 = {
			trigger_switch = {
				on_trigger = has_artifact_flag

				future_artifact_stat_diplomacy_flag = { artifact_owner = { add_artifact = ring_2_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_martial_flag = { artifact_owner = { add_artifact = ring_2_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_stewardship_flag = { artifact_owner = { add_artifact = ring_2_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_intrigue_flag = { artifact_owner = { add_artifact = ring_2_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_learning_flag = { artifact_owner = { add_artifact = ring_2_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
			}
		}

		ring_2_diplomacy = { artifact_owner = { add_artifact = ring_3_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_2_martial = { artifact_owner = { add_artifact = ring_3_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_2_stewardship = { artifact_owner = { add_artifact = ring_3_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_2_intrigue = { artifact_owner = { add_artifact = ring_3_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_2_learning = { artifact_owner = { add_artifact = ring_3_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		ring_3_diplomacy = { artifact_owner = { add_artifact = ring_4_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_3_martial = { artifact_owner = { add_artifact = ring_4_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_3_stewardship = { artifact_owner = { add_artifact = ring_4_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_3_intrigue = { artifact_owner = { add_artifact = ring_4_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_3_learning = { artifact_owner = { add_artifact = ring_4_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		ring_4_diplomacy = { artifact_owner = { add_artifact = ring_5_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_4_martial = { artifact_owner = { add_artifact = ring_5_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_4_stewardship = { artifact_owner = { add_artifact = ring_5_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_4_intrigue = { artifact_owner = { add_artifact = ring_5_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		ring_4_learning = { artifact_owner = { add_artifact = ring_5_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		# Bracelets
		bracelet_1 = {
			trigger_switch = {
				on_trigger = has_artifact_flag

				future_artifact_stat_diplomacy_flag = { artifact_owner = { add_artifact = bracelet_2_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_martial_flag = { artifact_owner = { add_artifact = bracelet_2_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_stewardship_flag = { artifact_owner = { add_artifact = bracelet_2_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_intrigue_flag = { artifact_owner = { add_artifact = bracelet_2_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
				future_artifact_stat_learning_flag = { artifact_owner = { add_artifact = bracelet_2_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
			}
		}

		bracelet_2_diplomacy = { artifact_owner = { add_artifact = bracelet_3_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_2_martial = { artifact_owner = { add_artifact = bracelet_3_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_2_stewardship = { artifact_owner = { add_artifact = bracelet_3_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_2_intrigue = { artifact_owner = { add_artifact = bracelet_3_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_2_learning = { artifact_owner = { add_artifact = bracelet_3_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		bracelet_3_diplomacy = { artifact_owner = { add_artifact = bracelet_4_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_3_martial = { artifact_owner = { add_artifact = bracelet_4_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_3_stewardship = { artifact_owner = { add_artifact = bracelet_4_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_3_intrigue = { artifact_owner = { add_artifact = bracelet_4_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_3_learning = { artifact_owner = { add_artifact = bracelet_4_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		bracelet_4_diplomacy = { artifact_owner = { add_artifact = bracelet_5_diplomacy new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_4_martial = { artifact_owner = { add_artifact = bracelet_5_martial new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_4_stewardship = { artifact_owner = { add_artifact = bracelet_5_stewardship new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_4_intrigue = { artifact_owner = { add_artifact = bracelet_5_intrigue new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		bracelet_4_learning = { artifact_owner = { add_artifact = bracelet_5_learning new_artifact = { save_event_target_as = target_new_reforged_artifact } } }

		## Weapons
		# Two-handed Swords
		sword_twohanded_1 = { artifact_owner = { add_artifact = sword_twohanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_twohanded_2 = { artifact_owner = { add_artifact = sword_twohanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_twohanded_3 = { artifact_owner = { add_artifact = sword_twohanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_twohanded_4 = { artifact_owner = { add_artifact = sword_twohanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# One-handed Swords
		sword_onehanded_1 = { artifact_owner = { add_artifact = sword_onehanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_onehanded_2 = { artifact_owner = { add_artifact = sword_onehanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_onehanded_3 = { artifact_owner = { add_artifact = sword_onehanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		sword_onehanded_4 = { artifact_owner = { add_artifact = sword_onehanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# Two-handed Axes
		axe_twohanded_1 = { artifact_owner = { add_artifact = axe_twohanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_twohanded_2 = { artifact_owner = { add_artifact = axe_twohanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_twohanded_3 = { artifact_owner = { add_artifact = axe_twohanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_twohanded_4 = { artifact_owner = { add_artifact = axe_twohanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# One-handed Axes
		axe_onehanded_1 = { artifact_owner = { add_artifact = axe_onehanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_onehanded_2 = { artifact_owner = { add_artifact = axe_onehanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_onehanded_3 = { artifact_owner = { add_artifact = axe_onehanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		axe_onehanded_4 = { artifact_owner = { add_artifact = axe_onehanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# Two-handed Maces
		mace_twohanded_1 = { artifact_owner = { add_artifact = mace_twohanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_twohanded_2 = { artifact_owner = { add_artifact = mace_twohanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_twohanded_3 = { artifact_owner = { add_artifact = mace_twohanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_twohanded_4 = { artifact_owner = { add_artifact = mace_twohanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# One-handed Maces
		mace_onehanded_1 = { artifact_owner = { add_artifact = mace_onehanded_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_onehanded_2 = { artifact_owner = { add_artifact = mace_onehanded_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_onehanded_3 = { artifact_owner = { add_artifact = mace_onehanded_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		mace_onehanded_4 = { artifact_owner = { add_artifact = mace_onehanded_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# Halberds
		halberd_1 = { artifact_owner = { add_artifact = halberd_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		halberd_2 = { artifact_owner = { add_artifact = halberd_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		halberd_3 = { artifact_owner = { add_artifact = halberd_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		halberd_4 = { artifact_owner = { add_artifact = halberd_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		# Spears
		spear_1 = { artifact_owner = { add_artifact = spear_2 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		spear_2 = { artifact_owner = { add_artifact = spear_3 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		spear_3 = { artifact_owner = { add_artifact = spear_4 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
		spear_4 = { artifact_owner = { add_artifact = spear_5 new_artifact = { save_event_target_as = target_new_reforged_artifact } } }
	}

}