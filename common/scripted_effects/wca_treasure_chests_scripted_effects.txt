add_common_lootbox_effect = {
	custom_tooltip = {
	text = add_lootbox_tooltip
		random_list = {
			1000 = {
				add_artifact = treasure_chest_common
			}
			100 = {
				modifier = {
					factor = 1.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_uncommon
			}
			25 = {
				modifier = {
					factor = 1.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_rare
			}
			5 = {
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							artifact_type = pirate_admiral_hat_gold
							is_artifact_equipped = yes
						}
					}
				}
				add_artifact = treasure_chest_epic
			}
		}
	}
}

add_uncommon_lootbox_effect = {
	custom_tooltip = {
	text = add_lootbox_tooltip
		random_list = {
			250 = {
				modifier = {
					factor = 0.75
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_common
			}
			500 = {
				add_artifact = treasure_chest_uncommon
			}
			125 = {
				modifier = {
					factor = 1.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_rare
			}
			25 = {
				modifier = {
				factor = 1.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_epic
			}
		}
	}
}

add_rare_lootbox_effect = {
	custom_tooltip = {
	text = add_lootbox_tooltip
		random_list = {
			125 = {
				modifier = {
				factor = 0.5
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_common
			}
			250 = {
				modifier = {
					factor = 0.75
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_uncommon
			}
			500 = {
				add_artifact = treasure_chest_rare
			}
			75 = {
				modifier = {
				factor = 1.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_epic
			}
		}
	}
}

add_epic_lootbox_effect = {
	custom_tooltip = {
	text = add_lootbox_tooltip
		random_list = {
			125 = {
				modifier = {
				factor = 0.25
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_common
			}
			125 = {
				modifier = {
					factor = 0.5
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_uncommon
			}
			250 = {
				modifier = {
					factor = 0.75
					any_artifact = {
						artifact_type = pirate_admiral_hat_gold
						is_artifact_equipped = yes
					}
				}
				add_artifact = treasure_chest_rare
			}
			500 = {
				add_artifact = treasure_chest_epic
			}
		}
	}
}

lootbox_open_effect = {
	random_list = {
		250 = { # Nothing
			modifier = {
				factor = 0
				OR = {
					has_character_flag = opened_lootbox_2
					has_character_flag = opened_lootbox_3
					has_character_flag = opened_lootbox_4
				}
			}
			modifier = {
				factor = 0
				any_artifact = {
					artifact_type = pirate_admiral_hat_gold
					is_artifact_equipped = yes
				}
			}
			set_character_flag = get_loot_nope
			custom_tooltip = {
				text = lootbox_nothing_tooltip
			}
		}
		1250 = { # Common
			modifier = {
				factor = 0.75
				has_character_flag = opened_lootbox_2
			}
			modifier = {
				factor = 0
				OR = {
					has_character_flag = opened_lootbox_3
					has_character_flag = opened_lootbox_4
				}
			}
			set_character_flag = get_loot_common
			custom_tooltip = {
				text = lootbox_common_tooltip
				random_list = {
					125 = {
						add_artifact = ring_1
					}
					125 = {
						add_artifact = crown_1
					}
					125 = {
						add_artifact = dagger_1
					}
				}
				get_random_gold_from_chest_effect = yes
			}
		}
		250 = { # Uncommon
			modifier = {
				factor = 2.5
				has_character_flag = opened_lootbox_2
			}
			modifier = {
				factor = 2.5
				has_character_flag = opened_lootbox_3
			}
			modifier = {
				factor = 0
				has_character_flag = opened_lootbox_4
			}
			modifier = {
				factor = 1.25
				any_artifact = {
					artifact_type = pirate_admiral_hat_gold
					is_artifact_equipped = yes
				}
			}
			set_character_flag = get_loot_uncommon
			custom_tooltip = {
				text = lootbox_uncommon_tooltip
				random_list = {
					125 = {
						add_artifact = ring_2_diplomacy
					}
					125 = {
						add_artifact = ring_2_martial
					}
					125 = {
						add_artifact = ring_2_stewardship
					}
					125 = {
						add_artifact = ring_2_intrigue
					}
					125 = {
						add_artifact = ring_2_learning
					}
					125 = {
						add_artifact = crown_2
					}
					125 = {
						add_artifact = dagger_2
					}
				}
				get_random_gold_from_chest_effect = yes
			}
		}
		100 = { # Rare
			modifier = {
				factor = 2.5
				has_character_flag = opened_lootbox_3
			}
			modifier = {
				factor = 2.5
				has_character_flag = opened_lootbox_4
			}
			modifier = {
				factor = 1.25
				any_artifact = {
					artifact_type = pirate_admiral_hat_gold
					is_artifact_equipped = yes
				}
			}
			set_character_flag = get_loot_rare
			custom_tooltip = {
				text = lootbox_rare_tooltip
				random_list = {
					125 = {
						add_artifact = ring_3_diplomacy
					}
					125 = {
						add_artifact = ring_3_martial
					}
					125 = {
						add_artifact = ring_3_stewardship
					}
					125 = {
						add_artifact = ring_3_intrigue
					}
					125 = {
						add_artifact = ring_3_learning
					}
					125 = {
						add_artifact = crown_3
					}
					125 = {
						add_artifact = dagger_3
					}
				}
				get_random_gold_from_chest_effect = yes
			}
		}
		50 = { # Epic
			modifier = {
				factor = 2.5
				has_character_flag = opened_lootbox_4
			}
			modifier = {
				factor = 1.25
				any_artifact = {
					artifact_type = pirate_admiral_hat_gold
					is_artifact_equipped = yes
				}
			}
			set_character_flag = get_loot_epic
			custom_tooltip = {
				text = lootbox_epic_tooltip
				random_list = {
					125 = {
						add_artifact = ring_4_diplomacy
					}
					125 = {
						add_artifact = ring_4_martial
					}
					125 = {
						add_artifact = ring_4_stewardship
					}
					125 = {
						add_artifact = ring_4_intrigue
					}
					125 = {
						add_artifact = ring_4_learning
					}
					125 = {
						add_artifact = crown_4
					}
					125 = {
						add_artifact = dagger_4
					}
				}
				get_random_gold_from_chest_effect = yes
			}
		}
		10 = { # Legendary
			modifier = {
				factor = 5.0
				has_character_flag = opened_lootbox_4
			}
			modifier = {
				factor = 2.0
				any_artifact = {
					artifact_type = pirate_admiral_hat_gold
					is_artifact_equipped = yes
				}
			}
			set_character_flag = get_loot_legendary
			custom_tooltip = {
				text = lootbox_legendary_tooltip
				random_list = {
					125 = {
						add_artifact = ring_5_diplomacy
					}
					125 = {
						add_artifact = ring_5_martial
					}
					125 = {
						add_artifact = ring_5_stewardship
					}
					125 = {
						add_artifact = ring_5_intrigue
					}
					125 = {
						add_artifact = ring_5_learning
					}
					125 = {
						add_artifact = dagger_5
					}
				}
				get_random_gold_from_chest_effect = yes
			}
		}
		5 = { # Unique aka easter eggs
			modifier = {
				factor = 0
				OR = {
					ai = yes # I infringe the rights of robots
					has_character_flag = opened_lootbox_1
					has_character_flag = opened_lootbox_2
					has_character_flag = opened_lootbox_3
					AND = {
						has_global_flag = obsidian_ring_found
						has_global_flag = pirate_king_hat_found
						has_global_flag = strange_plushie_found
						has_global_flag = butcher_hat_found
						has_global_flag = rare_pepe_summoned
					}
				}
			}
			set_character_flag = get_loot_unique
			custom_tooltip = {
				text = lootbox_unique_tooltip
				random_list = {
					25 = {
						modifier = {
							factor = 0
							has_global_flag = obsidian_ring_found
						}
						add_artifact = obsidian_ring
						set_global_flag = obsidian_ring_found
					}
					25 = {
						modifier = {
							factor = 0
							has_global_flag = pirate_king_hat_found
						}
						add_artifact = pirate_admiral_hat_gold
						set_global_flag = pirate_king_hat_found
					}
					25 = {
						modifier = {
							factor = 0
							has_global_flag = strange_plushie_found
						}
						add_artifact = strange_plushie
						set_global_flag = strange_plushie_found
					}
					25 = {
						modifier = {
							factor = 0
							has_global_flag = butcher_hat_found
						}
						add_artifact = cannibal_hat
						set_global_flag = butcher_hat_found
					}
					25 = {
						modifier = {
							factor = 0
							has_global_flag = rare_pepe_found
						}
						character_event = { id = WCTC.101 }
						set_global_flag = rare_pepe_found
					}
				}
			}
		}
	}
	character_event = { id = WCTC.2 }
}

get_random_gold_from_chest_effect = {
	if = {
		limit = {
			has_character_flag = get_loot_common
		}
		random_list = {
			125	= { wealth = 25		}
			100	= { wealth = 50		}
			75	= { wealth = 75		}
			50	= { wealth = 100	}
			25	= { wealth = 125	}
		}
	}
	if = {
		limit = {
			has_character_flag = get_loot_uncommon
		}
		random_list = {
			125	= { wealth = 150 }
			100	= { wealth = 175 }
			75	= { wealth = 200 }
			50	= { wealth = 225 }
			25	= { wealth = 250 }
		}
	}
	if = {
		limit = {
			has_character_flag = get_loot_rare
		}
		random_list = {
			125	= { wealth = 300 }
			100	= { wealth = 400 }
			75	= { wealth = 500 }
			50	= { wealth = 600 }
			25	= { wealth = 750 }
		}
	}
	if = {
		limit = {
			has_character_flag = get_loot_epic
		}
		random_list = {
			125	= { wealth = 1000 }
			100	= { wealth = 1125 }
			75	= { wealth = 1250 }
			50	= { wealth = 1375 }
			25	= { wealth = 1500 }
		}
	}
	if = {
		limit = {
			has_character_flag = get_loot_legendary
		}
		random_list = {
			125	= { wealth = 2000 }
			100	= { wealth = 2250 }
			75	= { wealth = 2500 }
			50	= { wealth = 2750 }
			25	= { wealth = 3000 }
		}
	}
}