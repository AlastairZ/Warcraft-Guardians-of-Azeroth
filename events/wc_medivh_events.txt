namespace = WCMDV

#############################
# 	Medivh in first war		#
#############################

#You open dark portal and let orcs come in
narrative_event = {
    id = WCMDV.100
	
	title = EVTTITLE_WCMDV_100
	desc = EVTDESC_WCMDV_100
	picture = GFX_evt_medivh_opening_dark_portal
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
	    NOT = { has_global_flag = medivh_openned_dark_portal_flag }
		has_character_flag = is_medivh
		year = 583
	}
	
	immediate = {
	    set_global_flag = medivh_openned_dark_portal_flag
		narrative_event = { id = WCMDV.101 days = 1 }
	}
	
	option = {
		name = EVTOPTA_WCMDV_100
	}
}

#Between good or evil
narrative_event = {
    id = WCMDV.101
	
	title = EVTTITLE_WCMDV_101
	desc = EVTDESC_WCMDV_101
	picture = GFX_evt_possessed_medivh
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	    set_character_flag = in_fight_with_sargeras
		if = { #If Aegwynn and Arcanagos is alive and capable
			limit = { 
			    c_60578 = {
					is_alive = yes
					is_incapable = no
				}
				c_62605 = {
					is_alive = yes
					is_incapable = no
				}
			}
			narrative_event = { id = WCMDV.102 days = 1 }
		}
		else = { #If they not
			narrative_event = { id = WCMDV.104 days = 4 }
		}
	}
	
	option = { #Side with cool kids
	    name = EVTOPTA_WCMDV_101
		
		set_character_flag = sided_with_sargeras
		
		piety = -1
	}
	
	option = { #No I am good
	    name = EVTOPTB_WCMDV_101
		
		set_character_flag = sided_with_good
		
		piety = 1
	}
}

#Aegwynn and Arcanagos
narrative_event = {
	id = WCMDV.102
	
	title = EVTTITLE_WCMDV_102
	desc = EVTDESC_WCMDV_102
	picture = GFX_evt_aegwynn_spell
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	portrait = c_60578
	
	immediate = {
	    c_62605 = {
		    opinion = { modifier = opinion_possessed_by_evil who = ROOT }
		}
		c_60578 = {
			opinion = { modifier = opinion_possessed_by_evil who = ROOT }
		}
	}
	
	option = {
		trigger = { has_character_flag = sided_with_sargeras }
		name = EVTOPTA_WCMDV_102
		narrative_event = { id = WCMDV.103 }
	}
	
	option = {
		trigger = { has_character_flag = sided_with_good }
		name = EVTOPTB_WCMDV_102
		narrative_event = { id = WCMDV.103 }
	}
}

#Arcanagos dead, Aegwynn banished
narrative_event = {
	id = WCMDV.103
	
	title = EVTTITLE_WCMDV_103
	desc = EVTDESC_WCMDV_103
	picture = GFX_evt_possessed_medivh
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	portrait = c_60578
	
	immediate = {
		c_62605 = {
			death = {
				death_reason = death_battle
				killer = 5000
			}
		}
		narrative_event = { id = WCMDV.104 days = 3 }
	}
	
	option = {
		trigger = { has_character_flag = sided_with_sargeras }
		name = EVTOPTA_WCMDV_103
		add_15_fel_corruption_effect = yes
	}
	
	option = {
		trigger = { has_character_flag = sided_with_good }
		name = EVTOPTB_WCMDV_103
		add_15_fel_corruption_effect = yes
	}
}

#Here come's Khadgar
narrative_event = {
    id = WCMDV.104
	
	title = EVTTITLE_WCMDV_104
	desc = EVTDESC_WCMDV_104
	picture = GFX_evt_karazhan_tower
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
	    c_59170 = { 
			move_character = ROOT
			save_event_target_as = student
			opinion = { modifier = opinion_teaching_me who = ROOT }
			set_character_flag = ask_to_be_mentor_ongoing_flag
			set_character_flag = training_mentor_mage_flag
			character_event = { id = WCCLS.2150 days = 1 }
		}
		ROOT = {
			save_event_target_as = mentor
		}
		narrative_event = { id = WCMDV.105 days = 1 }
	}
	
	option = {
		name = EVTOPTA_WCMDV_104
	}
}

#Khadgar in library
narrative_event = {
	id = WCMDV.105
	
	title = EVTTITLE_WCMDV_105
	desc = EVTDESC_WCMDV_105
	picture = GFX_evt_mage_in_library
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	
	option = { #Evil path
		trigger = { has_character_flag = sided_with_sargeras }
		name = EVTOPTA_WCMDV_105
		narrative_event = { id = WCMDV.106 }
	}
	
	option = { #Good path
		trigger = { has_character_flag = sided_with_good }
		name = EVTOPTB_WCMDV_105
	}
	
	option = { #Canon path
		name = EVTOPTC_WCMDV_105
	}
}

#Khadgar is wounded
narrative_event = {
	id = WCMDV.106
	
	title = EVTTITLE_WCMDV_106
	desc = EVTDESC_WCMDV_106
	picture = GFX_evt_medivh_spell
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		narrative_event = { id = WCMDV.107 days = 25 }
	}
	
	option = {
		name = EVTOPTA_WCMDV_106
		c_59170 = { add_trait = wounded }
	}
}

#Garona joins in
narrative_event = {
	id = WCMDV.107
	
	title = EVTTITLE_WCMDV_107
	desc = EVTDESC_WCMDV_107
	picture = GFX_evt_karazhan_tower
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	portrait = c_10620
	
	option = {
		name = EVTOPTA_WCMDV_107
		narrative_event = { id = WCMDV.108 days = 5 }
	}
	
	option = {
		trigger = { has_character_flag = sided_with_good }
		name = EVTOPTB_WCMDV_107
	}
	
	option = {
		trigger = { NOT = { has_character_flag = sided_with_sargeras } }
		name = EVTOPTB_WCMDV_107
		c_10620 = {
			death = {
				death_reason = death_missing
			}
		}
	}
}

#Garona falls in love with you
narrative_event = {
	id = WCMDV.108
	
	title = EVTTITLE_WCMDV_108
	desc = EVTDESC_WCMDV_108
	picture = GFX_evt_medivh_and_garona
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
	    c_10620 = { add_lover = ROOT }
	}
	
	option = {
		trigger = { has_character_flag = sided_with_sargeras }
		name = EVTOPTA_WCMDV_108
		narrative_event = { id = WCMDV.109 }
	}
	
	option = {
		trigger = { has_character_flag = sided_with_good }
		name = EVTOPTB_WCMDV_108
	}
}

#You mind control Garona
narrative_event = {
	id = WCMDV.109
	
	title = EVTTITLE_WCMDV_109
	desc = EVTDESC_WCMDV_109
	picture = GFX_evt_mind_control
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		c_10620 = {
			opinion = { modifier = opinion_loyal_servant who = ROOT }
		}
	}
	
	option = {
		name = EXCELLENT
	}
}