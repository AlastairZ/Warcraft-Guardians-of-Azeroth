#ID:
#1 - Pepe
#
#2&11 - Art Up
#3-10 - pings
#

namespace = WCAE

# Got Rare Pepe
character_event = {
	id = WCAE.1
	desc = EVTDESC_WCAE_1
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_intrigue

	is_triggered_only = yes

	option = {
		create_character = {
			random_traits = no
			name = "Mrglmargo-Mrglos"
			dynasty = none
			religion = ROOT
			race = murloc
			culture = ROOT
			female = no
			age = 26
			trait = creature_murloc # Murlocs = frogs, innit?
			trait = skilled_tactician
			trait = trickster
			trait = flanker
			trait = quick
			trait = strong
			trait = fair
			trait = robust
			trait = groomed
			trait = socializer
			trait = homosexual #Chemicals in the water are turning frogs gay
			trait = lustful
			attributes = {
				diplomacy = 6
				martial = 12
				stewardship = 8
				intrigue = 12
				learning = 4
			}
		}
		new_character = {
			if = {
				limit = {
					ROOT = {
						trait = creature_murloc
						trait = homosexual
						is_female = no
					}
				}
				add_lover = ROOT
			}
			if = {
				limit = {
					ROOT = {
						culture = pirate_culture
					}
				}
				add_trait = pirate
			}
			if = {
				limit = {
					ROOT = {
						religion_group = light_group
					}
				}
				add_trait = class_paladin_8 # Blue icon = rare
			}
			if = {
				limit = {
					ROOT = {
							religion_group = necromancy_group
					}
				}
				add_trait = class_death_knight_8 # Blue icon = rare
			}
			if = {
				limit = {
					ROOT = {
						NOT = {
							religion_group = light_group
							religion_group = necromancy_group
						}
					}
				}
				add_trait = class_warrior_8 # Blue icon = rare
			}
			add_friend = ROOT
			will_not_marry_effect = yes
			add_artifact = red_bandana
		}
		name = EVTOPTA_WCAE_1
	}
}

character_event = {
	id = WCAE.2 #Artifact Up
	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { #Generic upgrades

		trigger = {
			event_target:improved_artifact = {
				OR = {
					artifact_type = top_hat # top_hat to top_hat_2 to top_hat_3 to top_hat_4
					artifact_type = top_hat_2
					artifact_type = top_hat_3
					artifact_type = dagger_1 # dagger_1 to dagger_2 to dagger_3 to dagger_4
					artifact_type = dagger_2
					artifact_type = dagger_3
					artifact_type = ring_2_diplomacy # rings lvl up
					artifact_type = ring_3_diplomacy
					artifact_type = ring_4_diplomacy
					artifact_type = ring_2_martial
					artifact_type = ring_3_martial
					artifact_type = ring_4_martial
					artifact_type = ring_2_stewardship
					artifact_type = ring_3_stewardship
					artifact_type = ring_4_stewardship
					artifact_type = ring_2_intrigue
					artifact_type = ring_3_intrigue
					artifact_type = ring_4_intrigue
					artifact_type = ring_2_learning
					artifact_type = ring_3_learning
					artifact_type = ring_4_learning
					artifact_type = crown_1 # crowns lvlup
					artifact_type = crown_2
					artifact_type = crown_3
				}
			}
		}

		artifact_random_up_effect = yes

		name = {
			text = EVTOPTA_WCAE_4
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = top_hat
						artifact_type = top_hat_2
						artifact_type = top_hat_3
					}
				}
			}
		}

		name = {
			text = EVTOPTA_WCAE_5
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = dagger_1
						artifact_type = dagger_2
						artifact_type = dagger_3
					}
				}
			}	
		}

		name = {
			text = EVTOPTA_WCAE_6
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = crown_1
						artifact_type = crown_2
						artifact_type = crown_3
						artifact_type = ring_2_diplomacy
						artifact_type = ring_3_diplomacy
						artifact_type = ring_4_diplomacy
						artifact_type = ring_2_martial
						artifact_type = ring_3_martial
						artifact_type = ring_4_martial
						artifact_type = ring_2_stewardship
						artifact_type = ring_3_stewardship
						artifact_type = ring_4_stewardship
						artifact_type = ring_2_intrigue
						artifact_type = ring_3_intrigue
						artifact_type = ring_4_intrigue
						artifact_type = ring_2_learning
						artifact_type = ring_3_learning
						artifact_type = ring_4_learning
					}
				}
			}
		}
	}

	option = { # special hat

		trigger = {
			AND = {
				event_target:improved_artifact = {
					artifact_type = top_hat
				}
				OR = {
					culture = pirate_culture
					culture = blackwater
				}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = up_to_pirate_hat
		}

		custom_tooltip = { text = special_option_artifact_improve_tt }
		artifact_random_up_effect = yes

		name = {
			text = EVTOPTA_WCAE_3
			trigger = { event_target:improved_artifact = { artifact_type = top_hat } }
		}
	}

	option = { # paint blue

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					OR = {
						culture = pirate_culture
						culture = blackwater
					}
				}
				event_target:improved_artifact = { artifact_type = ring_1 }
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_blue
		}
		
		artifact_random_up_effect = yes

		tooltip_info = diplomacy
		name = {
			text = EVTOPTA_WCAE_blue
			trigger = { event_target:improved_artifact = { artifact_type = pirate_admiral_hat } }
		}

		name = {
			text = EVTOPTA_WCAE_blue_stone
			trigger = { event_target:improved_artifact = { artifact_type = ring_1 } }
		}
	}
	
	option = { # paint red

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					culture = pirate_culture
				}
				event_target:improved_artifact = { artifact_type = ring_1 }
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_red
		}
		
		artifact_random_up_effect = yes

		tooltip_info = martial
		name = {
			text = EVTOPTA_WCAE_red
			trigger = { event_target:improved_artifact = { artifact_type = pirate_admiral_hat } }
		}

		name = {
			text = EVTOPTA_WCAE_red_stone
			trigger = { event_target:improved_artifact = { artifact_type = ring_1 } }
		}
	}
	
	option = { # paint green

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					culture = blackwater
				}
				event_target:improved_artifact = { artifact_type = ring_1 }
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_green
		}
		
		artifact_random_up_effect = yes

		tooltip_info = stewardship
		name = {
			text = EVTOPTA_WCAE_green
			trigger = { event_target:improved_artifact = { artifact_type = pirate_admiral_hat } }
		}

		name = {
			text = EVTOPTA_WCAE_green_stone
			trigger = { event_target:improved_artifact = { artifact_type = ring_1 } }
		}
	}
	
	option = { #PRDX WHY
		trigger = {
			event_target:improved_artifact = {
				has_flag = four_or_more_up_choices
			}
		}
		name = EVTOPTA_WCMEME_back

		character_event = { id = WCAE.11 }
	}

	option = { #Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}
}

#Only 4 max option, so there additionals
character_event = {
	id = WCAE.11

	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { # paint violet

		trigger = {
			event_target:improved_artifact = { artifact_type = ring_1 }
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_violet
		}

		artifact_random_up_effect = yes

		tooltip_info = intrigue
		name = {
			text = EVTOPTA_WCAE_violet_stone
			trigger = { event_target:improved_artifact = { artifact_type = ring_1 } }
		}
	}
	
	# option = { # more than 4 variants generic upgrades ### OBSOLETE ###

		# trigger = {
			# event_target:improved_artifact = {
				# OR = {
					# artifact_type = ring_1 # ring_1 to ring_2 to ring_3
					# artifact_type = ring_2
				# }
			# }
		# }

		# artifact_random_up_effect = yes
		
		# name = EVTOPTA_WCAE_6
	# }
	
	option = { # paint white

		trigger = {
			event_target:improved_artifact = { artifact_type = ring_1 }
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_white
		}

		artifact_random_up_effect = yes

		tooltip_info = learning
		name = {
			text = EVTOPTA_WCAE_white_stone
			trigger = { event_target:improved_artifact = { artifact_type = ring_1 } }
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_back

		character_event = { id = WCAE.2 }

		ai_chance = {
			factor = 0
		}
	}
	
	option = { #Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}
	
}

#Results
character_event = { #success
	id = WCAE.3
	desc = EVTDESC_WCAE_7

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = pirate_admiral_hat
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
					}
				}
			}
			event_target:improved_artifact = { # Paint Pirate Hat
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = pirate_admiral_hat_blue } }
					paint_it_red 	= { artifact_owner = { add_artifact = pirate_admiral_hat_red } }
					paint_it_green 	= { artifact_owner = { add_artifact = pirate_admiral_hat_green } }
				}
			}
		}

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = ring_1
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
						has_flag = paint_it_violet
						has_flag = paint_it_white
					}
				}
			}
			event_target:improved_artifact = { # Paint Ring
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = ring_2_diplomacy		} }
					paint_it_red 	= { artifact_owner = { add_artifact = ring_2_martial		} }
					paint_it_green 	= { artifact_owner = { add_artifact = ring_2_stewardship	} }
					paint_it_violet = { artifact_owner = { add_artifact = ring_2_intrigue		} }
					paint_it_white	= { artifact_owner = { add_artifact = ring_2_learning		} }
				}
			}
		}
		
		if = {
			limit = {
				event_target:improved_artifact = {
					has_flag = up_to_pirate_hat
					artifact_type = top_hat
				}
			}

			event_target:improved_artifact = { # Specials
				trigger_switch = {
					on_trigger = artifact_type
					top_hat 			= { artifact_owner = { add_artifact = pirate_admiral_hat	} }
				}
			}
		}
		
		if = {
			limit = {
				NOT = {
					event_target:improved_artifact = {
						OR = {
							has_flag = up_to_pirate_hat
							has_flag = paint_it_blue
							has_flag = paint_it_red
							has_flag = paint_it_green
							has_flag = paint_it_violet
							has_flag = paint_it_white
						}
					}
				}
			}

			event_target:improved_artifact = { # Generic upgrades
				trigger_switch = {
					on_trigger = artifact_type
					crown_3 			= { artifact_owner = { add_artifact = crown_4	 			} }
					crown_2 			= { artifact_owner = { add_artifact = crown_3	 			} }
					crown_1 			= { artifact_owner = { add_artifact = crown_2				} }
					top_hat_3 			= { artifact_owner = { add_artifact = top_hat_4 			} }
					top_hat_2 			= { artifact_owner = { add_artifact = top_hat_3 			} }
					top_hat 			= { artifact_owner = { add_artifact = top_hat_2				} }
					dagger_3			= { artifact_owner = { add_artifact = dagger_4				} }
					dagger_2			= { artifact_owner = { add_artifact = dagger_3				} }				
					dagger_1			= { artifact_owner = { add_artifact = dagger_2				} }
					ring_2_diplomacy	= { artifact_owner = { add_artifact = ring_3_diplomacy		} }
					ring_3_diplomacy	= { artifact_owner = { add_artifact = ring_4_diplomacy		} }
					ring_4_diplomacy	= { artifact_owner = { add_artifact = ring_5_diplomacy		} }
					ring_2_martial		= { artifact_owner = { add_artifact = ring_3_martial		} }
					ring_3_martial		= { artifact_owner = { add_artifact = ring_4_martial		} }
					ring_4_martial		= { artifact_owner = { add_artifact = ring_5_martial		} }
					ring_2_stewardship	= { artifact_owner = { add_artifact = ring_3_stewardship	} }
					ring_3_stewardship	= { artifact_owner = { add_artifact = ring_4_stewardship	} }
					ring_4_stewardship	= { artifact_owner = { add_artifact = ring_5_stewardship	} }
					ring_2_intrigue		= { artifact_owner = { add_artifact = ring_3_intrigue		} }
					ring_3_intrigue		= { artifact_owner = { add_artifact = ring_4_intrigue		} }
					ring_4_intrigue		= { artifact_owner = { add_artifact = ring_5_intrigue		} }
					ring_2_learning		= { artifact_owner = { add_artifact = ring_3_learning		} }
					ring_3_learning		= { artifact_owner = { add_artifact = ring_4_learning		} }
					ring_4_learning		= { artifact_owner = { add_artifact = ring_5_learning		} }
				}
			}
		}

		new_artifact = {
			copy_artifact_history = event_target:improved_artifact
			set_artifact_original_owner = ROOT
		}
		event_target:improved_artifact = {
			clr_artifact_flag = up_to_pirate_hat
			clear_flags_with_prefix = paint_it_
			clr_artifact_flag = improved_artifact
			clear_event_target = improved_artifact
			destroy_artifact = yes
		}

	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_excellent
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = 25 } }
				improved_artifact_2 = { ROOT = { prestige = 50 } }				
				improved_artifact_3 = { ROOT = { prestige = 100 } }
				improved_artifact_4 = { ROOT = { prestige = 250 } }
			}
		}
	}
}

character_event = { #minor failure
	id = WCAE.4
	desc = EVTDESC_WCAE_5

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_baka
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25 } }
				improved_artifact_2 = { ROOT = { prestige = -50 } }				
				improved_artifact_3 = { ROOT = { prestige = -100 } }
				improved_artifact_4 = { ROOT = { prestige = -250 } }
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { piety = -25 					} }
				improved_artifact_2 = { ROOT = { prestige = -25		piety = -25	} }				
				improved_artifact_3 = { ROOT = { prestige = -50		piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -125	piety = -25	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		character_event = { id = WCAE.7 }
	}

	option = {
		name = EVTOPTA_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = 12.5 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = 25	} }				
				improved_artifact_3 = { ROOT = { prestige = -100	piety = 50	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = 125	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		character_event = { id = WCAE.8 }
	}
}

character_event = { # failure
	id = WCAE.6
	desc = EVTDESC_WCAE_6

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			set_description = artifact_damaged_not_improved_desc_rename
		}
		
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_baka
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50 } }
				improved_artifact_2 = { ROOT = { prestige = -100 } }				
				improved_artifact_3 = { ROOT = { prestige = -250 } }
				improved_artifact_4 = { ROOT = { prestige = -500 } }
			}
		}
	}

	option = {
		name = EVTOPTA_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = -25 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = -25	} }				
				improved_artifact_3 = { ROOT = { prestige = -125	piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = -25	} }
			}
		}
		
		set_character_flag = artifact_up_failure
		character_event = { id = WCAE.7 }
	}

	option = {
		name = EVTOPTA_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}
		
		set_character_flag = artifact_up_failure
		character_event = { id = WCAE.8 }

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50		piety = 25 } }
				improved_artifact_2 = { ROOT = { prestige = -100	piety = 50	} }				
				improved_artifact_3 = { ROOT = { prestige = -250	piety = 125	} }
				improved_artifact_4 = { ROOT = { prestige = -500	piety = 250	} }
			}
		}
	}
}

character_event = { #critical failure
	id = WCAE.5
	desc = EVTDESC_WCAE_4_1
	desc = EVTDESC_WCAE_4_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
			destroy_artifact = yes
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_less_good_man
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -100 } }
				improved_artifact_2 = { ROOT = { prestige = -250 } }				
				improved_artifact_3 = { ROOT = { prestige = -500 } }
				improved_artifact_4 = { ROOT = { prestige = -1000 } }
			}
		}
	}
}

character_event = { # Cruel ping
	id = WCAE.7
	desc = EVTOPTA_WCMEME_pingchanged

	picture = GFX_evt_bloody_knife_hf
	border = GFX_event_normal_frame_intrigue

	is_triggered_only = yes

	after = {
		clr_character_flag = artifact_up_failure
		clr_character_flag = artifact_up_minor_failure
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_minor_failure
		}
	
		random = {
			chance = 50

			if = {
				limit = {
					has_character_modifier = the_kind
				}
				remove_character_modifier = the_kind
			}
			else_if = {
				limit = {
					trait = kind
				}
				remove_trait = kind
			}
			else_if = {
				limit = {
					NOT = { trait = kind }
					NOT = { trait = cruel }
				}
				add_trait = cruel
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_cruel }
					trait = cruel
				}
				add_character_modifier = {
					name = the_cruel
					years = 3
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_failure
		}
	
		random = {
			chance = 25

			if = {
				limit = {
					has_character_modifier = the_kind
				}
				remove_character_modifier = the_kind
			}
			else_if = {
				limit = {
					trait = kind
				}
				remove_trait = kind
			}
			else_if = {
				limit = {
					NOT = { trait = kind }
					NOT = { trait = cruel }
				}
				add_trait = cruel
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_cruel }
					trait = cruel
				}
				add_character_modifier = {
					name = the_cruel
					years = 3
				}
			}
		}
	}
}

character_event = { # Kind ping
	id = WCAE.8
	desc = EVTOPTA_WCMEME_pingchanged

	picture = GFX_evt_fishing
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	after = {
		clr_character_flag = artifact_up_failure
		clr_character_flag = artifact_up_minor_failure
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_minor_failure
		}
	
		random = {
			chance = 50

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_cruel
			}
			else_if = {
				limit = {
					trait = cruel
				}
				remove_trait = cruel
			}
			else_if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
			else_if = {
				limit = {
					NOT = { trait = greedy }
					NOT = { trait = charitable }
				}
				add_trait = charitable
			}
			else_if = {
				limit = {
					NOT = { trait = cruel }
					NOT = { trait = kind }
				}
				add_trait = kind
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_kind }
					trait = kind
				}
				add_character_modifier = {
					name = the_kind
					years = 3
				}
			}
		}
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_failure
		}
	
		random = {
			chance = 75

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_cruel
			}
			else_if = {
				limit = {
					trait = cruel
				}
				remove_trait = cruel
			}
			else_if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
			else_if = {
				limit = {
					NOT = { trait = greedy }
					NOT = { trait = charitable }
				}
				add_trait = charitable
			}
			else_if = {
				limit = {
					NOT = { trait = cruel }
					NOT = { trait = kind }
				}
				add_trait = kind
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_kind }
					trait = kind
				}
				add_character_modifier = {
					name = the_kind
					years = 3
				}
			}
		}
	}
}

# Market Pings

character_event = { # success
	id = WCAE.9
	desc = EVTDESC_WCAE_8

	picture = GFX_evt_market
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		ROOT = {
			trigger_switch = {
				on_trigger = has_flag
				bought_artifact_top_hat					= { ROOT = { add_artifact = top_hat } }
				bought_artifact_rogue_dagger			= { ROOT = { add_artifact = dagger_1 } }				
				bought_artifact_copper_ring				= { ROOT = { add_artifact = ring_1	} }
				bought_artifact_ruler_crown				= { ROOT = { add_artifact = crown_1	} }
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_ok

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

character_event = { # failure
	id = WCAE.10
	desc = EVTDESC_WCAE_9_1
	desc = EVTDESC_WCAE_9_2

	picture = GFX_evt_market_hf
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_WCMEME_less_good_man

		prestige = -25
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

}