namespace = WCAE

# Got Rare Pepe
character_event = {
	id = WCAE.1
	desc = EVTDESC_WCAE_1
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_intrigue

	is_triggered_only = yes
	
	option = {
		create_character = {
			random_traits = no
			name = "Mrglmargo-Mrglos"
			dynasty = none
			religion = ROOT
			race = murloc
			culture = ROOT
			female = no
			age = 26
			trait = creature_murloc # Murloc = frogs, innit?
			trait = skilled_tactician
			trait = trickster
			trait = flanker
			trait = quick
			trait = strong
			trait = fair
			trait = robust
			trait = groomed
			trait = socializer
			trait = homosexual #Chemicals in the water are turning frogs gay
			trait = lustful
			attributes = {
				martial = 8
			}
		}
		new_character = {
			if = {
				limit = {
					ROOT = {
						trait = creature_murloc
						trait = homosexual
						is_female = no
					}
				}
				add_lover = ROOT
			}
			if = {
				limit = {
					ROOT = {
						culture = pirate_culture
					}
				}
				add_trait = pirate
			}
			if = {
				limit = {
					ROOT = {
						religion_group = light_group
					}
				}
				add_trait = class_paladin_8 # Blue icon = rare
			}
			if = {
				limit = {
					ROOT = {
							religion_group = necromancy_group
					}
				}
				add_trait = class_death_knight_8 # Blue icon = rare
			}
			if = {
				limit = {
					ROOT = {
						NOT = {
							religion_group = light_group
							religion_group = necromancy_group
						}
					}
				}
				add_trait = class_warrior_8 # Blue icon = rare
			}
			add_friend = ROOT
			will_not_marry_effect = yes
		}
		name = EVTOPTA_WCAE_1
	}
}

character_event = {
	id = WCAE.2 #Artifact Up
	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { # top_hat to top_hat_2 to top_hat_3

		trigger = {
			event_target:improved_artifact = {
				OR = {
					artifact_type = top_hat
					artifact_type = top_hat_2
				}
			}
		}

		wealth = local_third_party_score

		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_4

		#ai_chance = {
		#	factor = 0
		#	OR = {
		#		culture = pirate_culture
		#		culture = blackwater
		#	}
		#}
	}

	option = { # top_hat to pirate_hat

		trigger = {
			event_target:improved_artifact = {
				artifact_type = top_hat
			}
			OR = {
				culture = pirate_culture
				culture = blackwater
			}
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = up_to_pirate_hat
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_3

		#ai_chance = {
		#	factor = 1
		#}
	}

	option = { # paint pirate_hat blue

		trigger = {
			event_target:improved_artifact = {
				artifact_type = pirate_admiral_hat
			}
			OR = {
				culture = pirate_culture
				culture = blackwater
			}
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_blue
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_blue

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # paint pirate_hat red

		trigger = {
			event_target:improved_artifact = {
				artifact_type = pirate_admiral_hat
			}
			culture = pirate_culture
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_red
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_red

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # paint pirate_hat green

		trigger = {
			event_target:improved_artifact = {
				artifact_type = pirate_admiral_hat
			}
			culture = blackwater
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_green
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_green

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # dagger_1 to dagger_2 to dagger_3 to dagger_4

		trigger = {
			event_target:improved_artifact = {
				OR = {
					artifact_type = dagger_1
					artifact_type = dagger_2
					artifact_type = dagger_3
				}
			}
		}

		wealth = local_third_party_score

		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_5

		#ai_chance = {
		#	factor = 0
		#	OR = {
		#		culture = pirate_culture
		#		culture = blackwater
		#	}
		#}
	}
	
	option = { # ring_1 to ring_2 to ring_3

		trigger = {
			event_target:improved_artifact = {
				OR = {
					artifact_type = ring_1
					artifact_type = ring_2
				}
			}
		}

		wealth = local_third_party_score

		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_6

		#ai_chance = {
		#	factor = 0
		#	OR = {
		#		culture = pirate_culture
		#		culture = blackwater
		#	}
		#}
	}
	
	option = { # create ruby magic ring

		trigger = {
			event_target:improved_artifact = {
				artifact_type = ring_3
			}
			martial = 15
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_red
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_red_gem
		tooltip_info = martial

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # create emerald magic ring

		trigger = {
			event_target:improved_artifact = {
				artifact_type = ring_3
			}
			stewardship = 15
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_green
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_green_gem
		tooltip_info = stewardship

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # create sapphire magic ring

		trigger = {
			event_target:improved_artifact = {
				artifact_type = ring_3
			}
			diplomacy = 15
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_blue
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_blue_gem
		tooltip_info = diplomacy

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = { # create amethyst magic ring #### AI ONLY

		trigger = {
			event_target:improved_artifact = {
				artifact_type = ring_3
			}
			intrigue = 15
			ai = yes
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_violet
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_violet_gem
		tooltip_info = intrigue

		#ai_chance = {
		#	factor = 1
		#}
	}

	option = { # enchant

		trigger = {
			event_target:improved_artifact = {
				OR = {
					artifact_type = ring_of_diplomacy
					artifact_type = ring_of_martial
					artifact_type = ring_of_stewardship
					artifact_type = ring_of_intrigue
				} 
			}
		}

		wealth = local_third_party_score
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_enchant_gem
	}
	
	option = { #PRDX WHY
		trigger = {
			event_target:improved_artifact = {
				has_flag = four_or_more_up_choices
			}
		}
		name = EVTOPTA_WCMEME_back

		character_event = { id = WCAE.11 }

		ai_chance = {
			factor = 0
		}
	}

	option = { #Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}
}

#Results
character_event = { #success
	id = WCAE.3
	desc = EVTDESC_WCAE_7

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = pirate_admiral_hat
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
					}
				}
			}
			event_target:improved_artifact = { # Paint Pirate Hat
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = pirate_admiral_hat_blue } }
					paint_it_red 	= { artifact_owner = { add_artifact = pirate_admiral_hat_red } }
					paint_it_green 	= { artifact_owner = { add_artifact = pirate_admiral_hat_green } }
				}
			}
			event_target:improved_artifact = {
				clr_artifact_flag = paint_it_blue
				clr_artifact_flag = paint_it_red
				clr_artifact_flag = paint_it_green
			}
		}
		
		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = ring_3
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
						has_flag = paint_it_violet
					}
				}
			}
			event_target:improved_artifact = { # Paint Ring
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = ring_of_diplomacy } }
					paint_it_red 	= { artifact_owner = { add_artifact = ring_of_martial } }
					paint_it_green 	= { artifact_owner = { add_artifact = ring_of_stewardship } }
					paint_it_violet = { artifact_owner = { add_artifact = ring_of_intrigue } }
				}
			}
			event_target:improved_artifact = {
				clr_artifact_flag = paint_it_blue
				clr_artifact_flag = paint_it_red
				clr_artifact_flag = paint_it_green
				clr_artifact_flag = paint_it_violet
			}
		}
		
		if = {
			limit = {
				event_target:improved_artifact = {
					has_flag = up_to_pirate_hat
					artifact_type = top_hat
				}
			}
			add_artifact = pirate_admiral_hat
		}
		
		if_else = {
			limit = {
				NOT = { has_flag = up_to_pirate_hat }
			}
			event_target:improved_artifact = { # top_hat to top_hat_2
				trigger_switch = {
					on_trigger = artifact_type
					top_hat_2 	= { artifact_owner = { add_artifact = top_hat_3 } }
					top_hat 	= { artifact_owner = { add_artifact = top_hat_2 } }
				}
			}
		}

		event_target:improved_artifact = { # Generic upgrades
			trigger_switch = {
				on_trigger = artifact_type
				dagger_3			= { artifact_owner = { add_artifact = dagger_4				} }
				dagger_2			= { artifact_owner = { add_artifact = dagger_3				} }				
				dagger_1			= { artifact_owner = { add_artifact = dagger_2				} }
				ring_2				= { artifact_owner = { add_artifact = ring_3				} }
				ring_1				= { artifact_owner = { add_artifact = ring_2				} }
				ring_of_diplomacy	= { artifact_owner = { add_artifact = ring_of_diplomacy_2	} }
				ring_of_martial		= { artifact_owner = { add_artifact = ring_of_martial_2		} }
				ring_of_stewardship = { artifact_owner = { add_artifact = ring_of_stewardship_2	} }
				ring_of_intrigue	= { artifact_owner = { add_artifact = ring_of_intrigue_2	} }
			}
		}

		new_artifact = {
			copy_artifact_history = event_target:improved_artifact
			set_artifact_original_owner = ROOT
		}
		event_target:improved_artifact = {
			clr_artifact_flag = up_to_pirate_hat
			clr_artifact_flag = improved_artifact
			clear_event_target = improved_artifact
			destroy_artifact = yes
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_excellent
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = 25 } }
				improved_artifact_2 = { ROOT = { prestige = 50 } }				
				improved_artifact_3 = { ROOT = { prestige = 100 } }
				improved_artifact_4 = { ROOT = { prestige = 250 } }
			}
		}
	}
}

character_event = { #minor failure
	id = WCAE.4
	desc = EVTDESC_WCAE_5

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_baka
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25 } }
				improved_artifact_2 = { ROOT = { prestige = -50 } }				
				improved_artifact_3 = { ROOT = { prestige = -100 } }
				improved_artifact_4 = { ROOT = { prestige = -250 } }
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { piety = -25 					} }
				improved_artifact_2 = { ROOT = { prestige = -25		piety = -25	} }				
				improved_artifact_3 = { ROOT = { prestige = -50		piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -125	piety = -25	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		character_event = { id = WCAE.7 }
	}

	option = {
		name = EVTOPTA_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = 12.5 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = 25	} }				
				improved_artifact_3 = { ROOT = { prestige = -100	piety = 50	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = 125	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		character_event = { id = WCAE.8 }
	}
}

character_event = { # failure
	id = WCAE.6
	desc = EVTDESC_WCAE_6

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			set_description = artifact_damaged_not_improved_desc_rename
		}
		
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_baka
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50 } }
				improved_artifact_2 = { ROOT = { prestige = -100 } }				
				improved_artifact_3 = { ROOT = { prestige = -250 } }
				improved_artifact_4 = { ROOT = { prestige = -500 } }
			}
		}
	}

	option = {
		name = EVTOPTA_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = -25 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = -25	} }				
				improved_artifact_3 = { ROOT = { prestige = -125	piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = -25	} }
			}
		}
		
		set_character_flag = artifact_up_failure
		character_event = { id = WCAE.7 }
	}

	option = {
		name = EVTOPTA_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}
		
		set_character_flag = artifact_up_failure
		character_event = { id = WCAE.8 }

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50		piety = 25 } }
				improved_artifact_2 = { ROOT = { prestige = -100	piety = 50	} }				
				improved_artifact_3 = { ROOT = { prestige = -250	piety = 125	} }
				improved_artifact_4 = { ROOT = { prestige = -500	piety = 250	} }
			}
		}
	}
}

character_event = { #critical failure
	id = WCAE.5
	desc = EVTDESC_WCAE_4_1
	desc = EVTDESC_WCAE_4_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
			destroy_artifact = yes
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPTA_WCMEME_less_good_man
		
		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -100 } }
				improved_artifact_2 = { ROOT = { prestige = -250 } }				
				improved_artifact_3 = { ROOT = { prestige = -500 } }
				improved_artifact_4 = { ROOT = { prestige = -1000 } }
			}
		}
	}
}

character_event = { # Cruel ping
	id = WCAE.7
	desc = EVTOPTA_WCMEME_pingchanged

	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_intrigue

	is_triggered_only = yes

	after = {
		clr_character_flag = artifact_up_failure
		clr_character_flag = artifact_up_minor_failure
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_minor_failure
		}
	
		random = {
			chance = 50

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_kind
			}
			else_if = {
				limit = {
					trait = kind
				}
				remove_trait = kind
			}
			else_if = {
				limit = {
					NOT = { trait = kind }
					NOT = { trait = cruel }
				}
				add_trait = cruel
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_cruel }
					trait = cruel
				}
				add_character_modifier = {
					name = the_cruel
					years = 3
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_failure
		}
	
		random = {
			chance = 25

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_kind
			}
			else_if = {
				limit = {
					trait = kind
				}
				remove_trait = kind
			}
			else_if = {
				limit = {
					NOT = { trait = kind }
					NOT = { trait = cruel }
				}
				add_trait = cruel
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_cruel }
					trait = cruel
				}
				add_character_modifier = {
					name = the_cruel
					years = 3
				}
			}
		}
	}
}

character_event = { # Kind ping
	id = WCAE.8
	desc = EVTOPTA_WCMEME_pingchanged

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	after = {
		clr_character_flag = artifact_up_failure
		clr_character_flag = artifact_up_minor_failure
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_minor_failure
		}
	
		random = {
			chance = 50

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_cruel
			}
			else_if = {
				limit = {
					trait = cruel
				}
				remove_trait = cruel
			}
			else_if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
			else_if = {
				limit = {
					NOT = { trait = greedy }
					NOT = { trait = charitable }
				}
				add_trait = charitable
			}
			else_if = {
				limit = {
					NOT = { trait = cruel }
					NOT = { trait = kind }
				}
				add_trait = kind
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_kind }
					trait = kind
				}
				add_character_modifier = {
					name = the_kind
					years = 3
				}
			}
		}
	}

	option = {
		name = EVTOPTA_WCMEME_ok
	
		trigger = {
			has_flag = artifact_up_failure
		}
	
		random = {
			chance = 75

			if = {
				limit = {
					has_character_modifier = the_cruel
				}
				remove_character_modifier = the_cruel
			}
			else_if = {
				limit = {
					trait = cruel
				}
				remove_trait = cruel
			}
			else_if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
			else_if = {
				limit = {
					NOT = { trait = greedy }
					NOT = { trait = charitable }
				}
				add_trait = charitable
			}
			else_if = {
				limit = {
					NOT = { trait = cruel }
					NOT = { trait = kind }
				}
				add_trait = kind
			}
			else_if = {
				limit = {
					NOT = { has_character_modifier = the_kind }
					trait = kind
				}
				add_character_modifier = {
					name = the_kind
					years = 3
				}
			}
		}
	}
}

# Market Pings

character_event = { # success
	id = WCAE.9
	desc = EVTDESC_WCAE_8

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		ROOT = {
			trigger_switch = {
				on_trigger = has_flag
				bought_artifact_top_hat					= { ROOT = { add_artifact = top_hat } }
				bought_artifact_rogue_dagger			= { ROOT = { add_artifact = dagger_1 } }				
				bought_artifact_copper_ring				= { ROOT = { add_artifact = ring_1	} }
			}
		}
	}
	
	option = {
		name = EVTOPTA_WCMEME_ok

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

character_event = { # failure
	id = WCAE.10
	desc = EVTDESC_WCAE_9_1
	desc = EVTDESC_WCAE_9_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_WCMEME_less_good_man

		prestige = -25
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

}

#Only 4 max option, so there additionals
character_event = {
	id = WCAE.11

	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { # create amethyst magic ring

		trigger = {
			event_target:improved_artifact = {
				artifact_type = ring_3
			}
			intrigue = 15
		}

		wealth = local_third_party_score

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_violet
		}
		
		random_list = {
			80 = { #success
				custom_tooltip = {
					text = artifact_up_success_tooltip
					character_event = { id = WCAE.3 }
				}
				artifact_up_success_score = yes
			}
			10 = { # minor failure
				custom_tooltip = {
					text = artifact_up_failure_minor_tooltip
					character_event = { id = WCAE.4 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #failure
				custom_tooltip = {
					text = artifact_up_failure_tooltip
					character_event = { id = WCAE.6 }
				}
				artifact_up_failure_score = yes
			}
			5 = { #critical failure
				custom_tooltip = {
					text = artifact_up_critical_failure_tooltip
					character_event = { id = WCAE.5 }
				}
				artifact_up_critical_failure_score = yes
			}
		}

		name = EVTOPTA_WCAE_violet_gem
		tooltip_info = intrigue

		#ai_chance = {
		#	factor = 1
		#}
	}
	
	option = {
		name = EVTOPTA_WCMEME_back

		character_event = { id = WCAE.2 }

		ai_chance = {
			factor = 0
		}
	}
	
	option = { #Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}
	
}