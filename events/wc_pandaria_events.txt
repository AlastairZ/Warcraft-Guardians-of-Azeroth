namespace = WCPND

### ANKOAN COURTIERS ###

# Ankoan diplomat appears at court
character_event = {
	id = WCPND.100
	desc = EVTDESC_WCPND_100
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_diplomacy
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {		
		OR = {
			religion = waterspeaker
			religion = water_deities
			religion = neptulon_worship
		}
		NOT = { 
			culture = ankoan
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		# Can only appear after the Naga have spawned in the world
		has_global_flag = naga_resurfaced_flag
	}
	
	# More likely to appear in Tidehunter courts
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			religion = neptulon_worship
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = ankoan
			dynasty = culture
			religion = neptulon_worship
			female = no
			age = 30
			trait = charismatic_negotiator
			attributes = {
				diplomacy = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = socializer
				}
				30 = {
					add_trait = socializer
					add_trait = shrewd
				}
			}
			save_event_target_as = ankoan_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_100
		custom_tooltip = { text = ankoan_courtier_tooltip }
	}
}

# Ankoan administrator appears at court
character_event = {
	id = WCPND.101
	desc = EVTDESC_WCPND_101
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_economy
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {		
		OR = {
			religion = waterspeaker
			religion = water_deities
			religion = neptulon_worship
		}
		NOT = { 
			culture = ankoan
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		# Can only appear after the Naga have spawned in the world
		has_global_flag = naga_resurfaced_flag
	}
	
	# More likely to appear in Tidehunter courts
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			religion = neptulon_worship
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = ankoan
			dynasty = culture
			religion = neptulon_worship
			female = no
			age = 30
			trait = fortune_builder
			attributes = {
				stewardship = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = administrator
				}
				30 = {
					add_trait = administrator
					add_trait = shrewd
				}
			}
			save_event_target_as = ankoan_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_101
		custom_tooltip = { text = ankoan_courtier_tooltip }
	}
}

# Ankoan spy appears at court
character_event = {
	id = WCPND.102
	desc = EVTDESC_WCPND_102
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_intrigue
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {		
		OR = {
			religion = waterspeaker
			religion = water_deities
			religion = neptulon_worship
		}
		NOT = { 
			culture = ankoan
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		# Can only appear after the Naga have spawned in the world
		has_global_flag = naga_resurfaced_flag
	}
	
	# More likely to appear in Tidehunter courts
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			religion = neptulon_worship
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = ankoan
			dynasty = culture
			religion = neptulon_worship
			female = no
			age = 30
			trait = intricate_webweaver
			attributes = {
				intrigue = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = schemer
					add_trait = class_rogue_3
				}
				15 = {
					add_trait = schemer
					add_trait = shrewd
					add_trait = class_rogue_3
				}
				15 = {
					add_trait = schemer
					add_trait = shrewd
					add_trait = class_rogue_4
				}
			}
			save_event_target_as = ankoan_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_102
		custom_tooltip = { text = ankoan_courtier_tooltip }
	}
}

# Ankoan elder appears at court
character_event = {
	id = WCPND.103
	desc = EVTDESC_WCPND_103
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_religion
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {		
		OR = {
			religion = waterspeaker
			religion = water_deities
			religion = neptulon_worship
		}
		NOT = { 
			culture = ankoan
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		# Can only appear after the Naga have spawned in the world
		has_global_flag = naga_resurfaced_flag
	}
	
	# More likely to appear in Tidehunter courts
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			religion = neptulon_worship
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = ankoan
			dynasty = culture
			religion = neptulon_worship
			female = no
			age = 30
			trait = mastermind_theologian
			attributes = {
				learning = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = mystic
					add_trait = class_shaman_3
				}
				15 = {
					add_trait = mystic
					add_trait = shrewd
					add_trait = class_shaman_3
				}
				15 = {
					add_trait = mystic
					add_trait = shrewd
					add_trait = class_shaman_4
				}
			}
			save_event_target_as = ankoan_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_103
		custom_tooltip = { text = ankoan_courtier_tooltip }
	}
}

# Ankoan hero appears at court
character_event = {
	id = WCPND.104
	desc = EVTDESC_WCPND_104
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_war
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {		
		OR = {
			religion = waterspeaker
			religion = water_deities
			religion = neptulon_worship
		}
		NOT = { 
			culture = ankoan
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		# Can only appear after the Naga have spawned in the world
		has_global_flag = naga_resurfaced_flag
	}
	
	# More likely to appear in Tidehunter courts
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			religion = neptulon_worship
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = ankoan
			dynasty = culture
			religion = neptulon_worship
			female = no
			age = 30
			trait = brilliant_strategist
			attributes = {
				martial = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				30 = {
					add_trait = sturdy
					add_trait = class_warrior_3
				}
				30 = {
					add_trait = sturdy
					add_trait = class_hunter_3
				}
				15 = {
					add_trait = sturdy
					add_trait = strong
					add_trait = class_warrior_3
				}
				15 = {
					add_trait = sturdy
					add_trait = strong
					add_trait = class_hunter_3
				}
				5 = {
					add_trait = sturdy
					add_trait = strong
					add_trait = class_warrior_4
				}
				5 = {
					add_trait = sturdy
					add_trait = strong
					add_trait = class_hunter_4
				}
			}
			save_event_target_as = ankoan_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_104
		custom_tooltip = { text = ankoan_courtier_tooltip }
	}
}

### WANDERING ISLE PANDAREN ###

# on_bi_yearly_pulse
# A Giant Seafaring Turtle Sighted! - initial
character_event = {
	id = WCPND.199

	is_triggered_only = yes
	hide_window = yes

	ai = no

	trigger = {
		OR = {
			multiplayer = no
			is_multiplayer_host_character = yes
		}
		NOT = { 
			has_global_flag = wandering_isle_sighted
			has_game_rule = {
				name = mists_of_pandaria
				value = off
			}
		}
		year = 610	# Roughly 3 years before Mists of Pandaria disappear
	}

	immediate = {
		set_global_flag = wandering_isle_sighted

		any_player = {
			narrative_event = { id = WCPND.200 }
		}
	}
}

# This event unlocks the possibility for random Wandering Isle Pandaren courtiers to spawn in the world
# A Giant Seafaring Turtle Sighted! - pinger
narrative_event = {
	id = WCPND.200
	title = EVTTITLE_WCPND_200
	desc = {
		trigger = { capital_scope = { region = world_pandaria } }
		text = EVTDESC_WCPND_200_PANDARIA
	}
	desc = {
		trigger = { NOT = { capital_scope = { region = world_pandaria } } }
		text = EVTDESC_WCPND_200_AZEROTH
	}
	picture = GFX_evt_wandering_isle
	border = GFX_event_narrative_frame_diplomacy
	
	is_triggered_only = yes
	hide_from = yes
	
	# Non-Pandarian
	option = {
		trigger = {
			NOT = { 
				culture_group = pandaren_group
				culture_group = hozen_group
				culture = jinyu
				culture = mogu
				culture = mantid
				culture = yaungol
				culture = grummle
				culture = saurok
			} 
		}
		name = EVTOPTA_WCPND_200
	}
	
	# Pandarian - Friendly
	option = {
		trigger = {
			OR = {
				culture_group = pandaren_group
				culture = jinyu
				culture = grummle
			}
		}
		name = EVTOPTB_WCPND_200
	}
	
	# Pandarian - Hostile
	option = {
		trigger = {
			OR = {
				culture = mogu
				culture = mantid
				culture = yaungol
				culture = saurok
			}
		}
		name = EVTOPTC_WCPND_200
	}
	# Hozen
	option = {
		trigger = { culture_group = hozen_group }
		name = EVTOPTD_WCPND_200
	}
}

# Wandering Pandaren poet appears at court
character_event = {
	id = WCPND.201
	desc = EVTDESC_WCPND_201
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_diplomacy
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { 
			evil_public_religion_trigger = yes
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		OR = { 
			has_global_flag = wandering_isle_sighted
			has_game_rule = {
				name = mists_of_pandaria
				value = off
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = wandering_pandaren
			dynasty = culture
			religion = august_celestials
			female = no
			age = 30
			trait = charismatic_negotiator
			attributes = {
				diplomacy = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = poet
				}
				30 = {
					add_trait = poet
					add_trait = shrewd
				}
			}
			save_event_target_as = wandering_pandaren_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_201
		custom_tooltip = { text = wandering_pandaren_courtier_tooltip }
	}
}

# Wandering Pandaren mason appears at court
character_event = {
	id = WCPND.202
	desc = EVTDESC_WCPND_202
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_economy
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { 
			evil_public_religion_trigger = yes
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		OR = { 
			has_global_flag = wandering_isle_sighted
			has_game_rule = {
				name = mists_of_pandaria
				value = off
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = wandering_pandaren
			dynasty = culture
			religion = august_celestials
			female = no
			age = 30
			trait = fortune_builder
			attributes = {
				stewardship = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = master_builder
				}
				30 = {
					add_trait = master_builder
					add_trait = shrewd
				}
			}
			save_event_target_as = wandering_pandaren_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_202
		custom_tooltip = { text = wandering_pandaren_courtier_tooltip }
	}
}

# Wandering Pandaren priest appears at court
character_event = {
	id = WCPND.203
	desc = EVTDESC_WCPND_203
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_religion
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { 
			evil_public_religion_trigger = yes
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		OR = { 
			has_global_flag = wandering_isle_sighted
			has_game_rule = {
				name = mists_of_pandaria
				value = off
			}
		}
	}

	immediate = {
		create_character = {
			random_traits = yes
			culture = wandering_pandaren
			dynasty = culture
			religion = august_celestials
			female = no
			age = 30
			trait = mastermind_theologian
			attributes = {
				learning = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = mystic
					add_trait = class_priest_3
				}
				15 = {
					add_trait = mystic
					add_trait = shrewd
					add_trait = class_priest_3
				}
				15 = {
					add_trait = mystic
					add_trait = shrewd
					add_trait = class_priest_4
				}
			}
			save_event_target_as = wandering_pandaren_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_203
		custom_tooltip = { text = wandering_pandaren_courtier_tooltip }
	}
}

# Wandering Pandaren brewmaster appears at court
character_event = {
	id = WCPND.204
	desc = EVTDESC_WCPND_204
	picture = GFX_evt_emissary #PH
	border = GFX_event_normal_frame_war
	
	min_age = 16
	prisoner = no
	only_playable = yes
	capable_only = yes
	only_independent = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { 
			evil_public_religion_trigger = yes
			is_incapable = yes
			is_inaccessible_trigger = yes
		}
		OR = { 
			has_global_flag = wandering_isle_sighted
			has_game_rule = {
				name = mists_of_pandaria
				value = off
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			culture = wandering_pandaren
			dynasty = culture
			religion = august_celestials
			female = no
			age = 30
			trait = brilliant_strategist
			attributes = {
				martial = 10
			}
			flag = ai_flag_refuse_conversion
		}
		new_character = {
			remove_lifestyle_trait_effect = yes
			random_list = {
				70 = {
					add_trait = drunkard
				}
				30 = {
					add_trait = drunkard
					add_trait = strong
				}
			}
			save_event_target_as = wandering_pandaren_courtier
		}
	}
	
	option = {
		name = EVTOPTA_WCPND_204
		custom_tooltip = { text = wandering_pandaren_courtier_tooltip }
	}
}