namespace = WCTC

character_event = {
	id = WCTC.1
	desc = EVTDESC_WCTC_1
	picture = GFX_evt_vikings_arriving_oldgods
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_WCMEME_excellent
		custom_tooltip = {
			text = add_lootbox_tooltip
			random_list = {
				125 = {
					add_common_lootbox_effect = yes
				}
				50 = {
					modifier = {
						factor = 1.25
						any_artifact = {
							artifact_type = pirate_admiral_hat_gold
							is_artifact_equipped = yes
						}
					}
					add_uncommon_lootbox_effect = yes
				}
				25 = {
					modifier = {
						factor = 1.25
						any_artifact = {
							artifact_type = pirate_admiral_hat_gold
							is_artifact_equipped = yes
						}
					}
					add_rare_lootbox_effect = yes
				}
				5 = {
					modifier = {
						factor = 0
						NOT = {
							any_artifact = {
								artifact_type = pirate_admiral_hat_gold
								is_artifact_equipped = yes
							}
						}
					}
					add_epic_lootbox_effect = yes
				}
			}
		}
	}
}

character_event = {
	id = WCTC.2
	desc = EVTDESC_WCTC_2
	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_WCMEME_YES
		lootbox_open_effect = yes
	}
	
	option = { #Exit

		name = EVT_OPTD_MNM_9310
		
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}
		
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = opened_lootbox_
		clear_flags_with_prefix = get_loot_

		ai_chance = {
			factor = 0
		}
	}
}

# Ping

character_event = {
	id = WCTC.3

	desc = { # Nothing
		trigger = { has_character_flag = get_loot_nope }
		text = EVTDESC_WCTC_no_loot
	}
	desc = { # Common
		trigger = { has_character_flag = get_loot_common }
		text = EVTDESC_WCTC_common_loot
	}
	desc = { # Uncommon
		trigger = { has_character_flag = get_loot_uncommon }
		text = EVTDESC_WCTC_uncommon_loot
	}
	desc = { # Rare
		trigger = { has_character_flag = get_loot_rare }
		text = EVTDESC_WCTC_rare_loot
	}
	desc = { # Epic
		trigger = { has_character_flag = get_loot_epic }
		text = EVTDESC_WCTC_epic_loot
	}
	desc = { # Legendary
		trigger = { has_character_flag = get_loot_legendary }
		text = EVTDESC_WCTC_legendary_loot
	}

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
			destroy_artifact = yes
		}
	}
	
	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = opened_lootbox_
		clear_flags_with_prefix = get_loot_
	}
	
	option = {
	
		name = {# Nothing
			trigger = { has_character_flag = get_loot_nope }
			text = EVTOPTA_WCTC_no_loot
		}
		name = {# Common
			trigger = { has_character_flag = get_loot_common }
			text = EVTOPTA_WCTC_common_loot
		}
		name = {# Uncommon
			trigger = { has_character_flag = get_loot_uncommon }
			text = EVTOPTA_WCTC_uncommon_loot
		}
		name = {# Rare
			trigger = { has_character_flag = get_loot_rare }
			text = EVTOPTA_WCTC_rare_loot
		}
		name = {# Epic
			trigger = { has_character_flag = get_loot_epic }
			text = EVTOPTA_WCTC_epic_loot
		}
		name = {# Legendary
			trigger = { has_character_flag = get_loot_legendary }
			text = EVTOPTA_WCTC_legendary_loot
		}
	}
}
