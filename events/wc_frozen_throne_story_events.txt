namespace = WCTFT

### Plaguelands Civil War ###
# Ping event
province_event = {
	id = WCTFT.99

	is_triggered_only = yes
	hide_window = yes

	trigger = {
		start_date = 605.6.6
		NOT = { 
			has_global_flag = plaguelands_civil_war_ongoing
			has_game_rule = {
				name = frozen_throne_story
				value = off
			}
		}
	}

	immediate = {
		set_global_flag = plaguelands_civil_war_ongoing
		d_lordamere = {
			holder_scope = { narrative_event = { id = WCTFT.100 } }
		}
	}
}

# Notifies the world of the ongoing civil war, Garithos can choose his path of reclamation
narrative_event = {
	id = WCTFT.100
	title = EVTTITLE_WCTFT_100
	desc = EVTDESC_WCTFT_100
	picture = GFX_evt_scourge_march
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes

	major = yes
	major_trigger = {
		ai = no
	}
	show_root = yes

	option = { #To the strongest!
		trigger = { character = ROOT }
		k_lordaeron = {
			if = {
				limit = { has_holder = yes }
				holder_scope = {
					set_character_flag = event_war_exception_flag
					reverse_unsafe_war = {
						target = ROOT
						casus_belli = invasion
						thirdparty_title = PREV
					}
				}
			}
		}
		prestige = 500
		piety = -250
		name = EVTOPTA_WCTFT_100
		ai_chance = {
			factor = 0
			modifier = {
				factor = 2
				trait = ambitious
			}
		}
	}

	option = { #To the rightful heir!
		trigger = { character = ROOT }
		k_lordaeron = {
			if = {
				limit = { has_holder = yes }
				holder_scope = {
					set_character_flag = event_war_exception_flag
					reverse_unsafe_war = {
						target = c_60004
						casus_belli = other_claim
						thirdparty = ROOT
						thirdparty_title = PREV
					}
				}
			}
		}
		prestige = 250
		name = EVTOPTB_WCTFT_100
		ai_chance = {
			factor = 1
		}
	}
	
	option = { #Scourge reacts
		trigger = {
			NOT = { character = ROOT }
			religion = death_god
		}
		name = EVTOPTC_WCTFT_100
	}
	
	option = { #Forsaken react
		trigger = {
			NOT = { character = ROOT }
			religion = forsaken_cult
		}
		name = EVTOPTD_WCTFT_100
	}
	
	option = { #Humans react
		trigger = {
			NOT = { 
				character = ROOT
				religion = death_god
				religion = forsaken_cult
			}
			culture_group = human_group
		}
		name = EVTOPTE_WCTFT_100
	}
	
	option = { #Legion reacts
		trigger = {
			NOT = { character = ROOT }
			religion = burning_legion_religion
		}
		name = EVTOPTF_WCTFT_100
	}
	
	option = { #Who cares
		trigger = {
			NOT = { 
				character = ROOT
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
				culture_group = human_group
			}
		}
		name = EVTOPTG_WCTFT_100
	}
}

# Resistance Calia Path: Garithos victorious, Calia installed
narrative_event = {
	id = WCTFT.110
	title = EVTTITLE_WCTFT_110
	desc = EVTDESC_WCTFT_110
	picture = GFX_evt_stormwind_champion
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes
	
	major = yes
	major_trigger = {
		ai = no
	}
	show_root = yes
	
	trigger = {
		NOT = { 
			has_game_rule = {
				name = frozen_throne_story
				value = off
			}
		}
	}

	immediate = {
		clr_global_flag = plaguelands_civil_war_ongoing
		
		#Add Calia to faction
		event_target:target_calia = { join_alliance_faction_effect = yes }
		
		#Vassalize the Grand Marshal
		event_target:target_garithos = {
			set_defacto_liege = event_target:target_calia
		}
		
		#Give nicknames
		event_target:target_calia = {
			give_nickname = nick_the_deliverer
		}
		event_target:target_garithos = {
			give_nickname = nick_the_liberator
			if = {
				limit = {
					has_dlc = "Holy Fury"
				}
				create_bloodline = {
					type = liberator_of_lordaeron
				}
			}
		}
		
		#Ping the Silver Hand leader
		d_order_of_the_silver_hand = {
			if = {
				limit = {
					has_holder = yes
					is_primary_holder_title = yes
				}
				holder_scope = { 
					narrative_event = { id = WCTFT.111 days = 7 } 
				}
			}
		}
	}

	option = { #A new hope for Lordaeron
		trigger = {
			religion = holy_light
		}
		name = EVTOPTA_WCTFT_110
	}
	
	option = { #She won't rule for long
		trigger = {
			OR = {
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
			}
		}
		name = EVTOPTB_WCTFT_110
	}
	
	option = { #At least she can be reasoned with
		trigger = {
			culture = blood_elf
			NOT = {
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
				religion = holy_light
			}
		name = EVTOPTC_WCTFT_110
		}
	}

	option = { #Pah!
		trigger = {
			NOT = { 
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
				religion = holy_light
				culture = blood_elf
			}
		}
		name = EVTOPTD_WCTFT_110
	}
}

# Resistance Calia Path: The Silver Hand's Loyalties
narrative_event = {
	id = WCTFT.111
	title = EVTTITLE_WCTFT_111
	desc = EVTDESC_WCTFT_111
	picture = GFX_evt_paladin_human
	border = GFX_event_narrative_frame_diplomacy

	is_triggered_only = yes
	
	show_root = yes
	
	trigger = {
		NOT = { 
			has_game_rule = {
				name = frozen_throne_story
				value = off
			}
		}
	}
	
	option = { #We stand with Lordaeron
		# Raymond George's faction in Tyr's Hand secedes from the Silver Hand (creates d_argent_dawn)
		# The Highlord
		if = {
			limit = {
				c_60625 = {		# Raymond
					ai = yes

					is_alive = yes

					religion = holy_light
					culture = lordaeronian
				}
			}
			c_60625 = { save_event_target_as = target_argent_highlord }
		}
		else = {
			create_character = {
				female = no
				dynasty = none
				culture = lordaeronian religion = holy_light
				trait=brilliant_strategist
				trait=creature_human
				trait=class_paladin_7
				trait=wroth trait=zealous
				age = 50
			}
			new_character = { save_event_target_as = target_argent_highlord }
		}
		event_target:target_argent_highlord = {
			religion = holy_light
			clear_secret_religion = yes
			activate_title = { title = d_argent_dawn status = yes }
			d_argent_dawn = { grant_title = PREV }
			religion_authority = {
				modifier = religious_order_formed
				years = 10
			}
			set_defacto_liege = THIS
			wealth = 500
		}
		
		# Transfer eastern Silver Hand provinces to Argent Dawn
		d_order_of_the_silver_hand = { 
			holder_scope = { 
				any_vassal = { 
					if = {
						limit = {
							de_jure_liege_or_above = k_stratholme
						} 
					}
				} 
				set_defacto_liege = d_argent_dawn
			} 
		}
		
		# Make the Silver Hand vassal of Lordaeron
		d_order_of_the_silver_hand = {
			set_defacto_liege = k_lordaeron
		}
		
		# Notify the world of the split
		event_target:target_argent_highlord = {
			narrative_event = { id = WCTFT.112 }
		}
		
		#Calia is pleased
		#opinion modifier goes here
		
		name = EVTOPTA_WCTFT_111
		
		ai_chance = {
			factor = 1
		}
	}
	
	option = { #The Order stands alone
		#Calia is outraged
		#opinion modifier goes here
		
		name = EVTOPTB_WCTFT_111
		
		ai_chance = {
			factor = 0
		}
	}
}


# Resistance Calia Path: The Argent Dawn is formed
narrative_event = {
	id = WCTFT.112
	title = EVTTITLE_WCTFT_112
	desc = EVTDESC_WCTFT_112
	picture = GFX_evt_paladin_human
	border = GFX_event_narrative_frame_diplomacy

	is_triggered_only = yes
	
	major = yes
	major_trigger = {
		ai = no
	}
	show_root = yes
	
	trigger = {
		NOT = { 
			has_game_rule = {
				name = frozen_throne_story
				value = off
			}
		}
	}
	
	option = { #Most unfortunate
		trigger = {
			religion = holy_light
		}
		name = EVTOPTA_WCTFT_112
	}
	
	option = { #Fools
		trigger = {
			NOT = {
				religion = holy_light
			}
		}
		name = EVTOPTB_WCTFT_112
	}
}

# Resistance Garithos Path: Garithos claims the throne
narrative_event = {
	id = WCTFT.120
	title = EVTTITLE_WCTFT_120
	desc = EVTDESC_WCTFT_120
	picture = GFX_evt_stormwind_champion
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes
	
	major = yes
	major_trigger = {
		ai = no
	}
	show_root = yes

	immediate = {
		clr_global_flag = plaguelands_civil_war_ongoing
		
		#Give nicknames
		event_target:target_garithos = {
			give_nickname = nick_the_usurper
			if = {
				limit = {
					has_dlc = "Holy Fury"
				}
				create_bloodline = {
					type = the_scarlet_king
				}
			}
		}
		
		#Ping Abbendis
		
		#Ping Alliance Leader
	}
	
	option = { #Bunch of ingrates
		trigger = { event_target:target_garithos }
		name = EVTOPTA_WCTFT_120
	}

	option = { #An uncertain future
		trigger = {
			religion = holy_light
		}
		name = EVTOPTB_WCTFT_120
	}
	
	option = { #He won't last long
		trigger = {
			OR = {
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
			}
		}
		name = EVTOPTC_WCTFT_120
	}
	
	option = { #Horrible
		trigger = {
			culture = blood_elf
			NOT = {
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
				religion = holy_light
			}
		}
		name = EVTOPTD_WCTFT_120
	}

	option = { #That place is a total disaster
		trigger = {
			NOT = { 
				religion = death_god
				religion = forsaken_cult
				religion = burning_legion_religion
				religion = holy_light
				culture = blood_elf
			}
		}
		name = EVTOPTE_WCTFT_120
	}
}

# Resistance Garithos Path: Alliance Outrage

# Resistance Garithos Path: The Abbendis Schism

# Resistance Garithos Path: Raymond's Response

# Forsaken Path: Sylvanas victorious

# Forsaken Path: Renault's Patricide

# Forsaken Path: Blood and Silver

# Forsaken Path: Induction into the Horde

### Old Hatreds ###

### War of the Frozen Throne ###

# Illidari Victory: Containment

# Illidari Victory: The Prince's Return

# Illidari Defeat: Cleanup